# preprocess: remove the header before running this command
date; cut -f 4,5,6,7,20,21,22,23 TN_snv_count.txt | awk '{ $1==""?a="0":a=$1;  $2==""?b="0":b=$2; $3==""?c="0":c=$3; $4==""?d="0":d=$4; $5==""?e="0":e=$5; $6==""?f="0":f=$6; $7==""?g="0":g=$7; $8==""?h="0":h=$8; print a,'\t',b,'\t',c,'\t',d,'\t',e,'\t',f,'\t',g,'\t',h }' | awk 'function abs(x){return ((x < 0.0) ? -x : x)} { if ($1+$5 >= $2+$6) {one=$1; two=$5; three=$2; four=$6;} else {one=$2; two=$6; three=$1; four=$5;} if ($3+$7 > $three+$four) { if ($3+$7 > $one+$two) {three=one; four=two; one=$3; two=$7;} else {three=$3; four=$7;} } if ($4+$8 > $three+$four) { if ($4+$8 > $one+$two) {three=one; four=two; one=$4; two=$8;} else { three=$4; four=$8;} }; if (one+two==0 || one+three==0 || three+four==0 || two+four==0) {print "NaN"} else {N=one+two+three+four; adbc= abs(one*four-two*three)-N/2; print N*adbc*adbc/(one+three)/(two+four)/(one+two)/(three+four)} }' > chisq.txt; date
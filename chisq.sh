date; tail -n +2 TN_snv_count.txt | cut -f 4,5,6,7,20,21,22,23,2 | awk '{ $2==""?a="0":a=$2;  $3==""?b="0":b=$3; $4==""?c="0":c=$4; $5==""?d="0":d=$5; $6==""?e="0":e=$6; $7==""?f="0":f=$7; $8==""?g="0":g=$8; $9==""?h="0":h=$9; print a,'\t',b,'\t',c,'\t',d,'\t',e,'\t',f,'\t',g,'\t',h,'\t',$1 }' | awk 'function abs(x){return ((x < 0.0) ? -x : x)} { if ($1+$5 >= $2+$6) {one=$1; two=$5; three=$2; four=$6;} else {one=$2; two=$6; three=$1; four=$5;} if ($3+$7 > $three+$four) { if ($3+$7 > $one+$two) {three=one; four=two; one=$3; two=$7;} else {three=$3; four=$7;} } if ($4+$8 > $three+$four) { if ($4+$8 > $one+$two) {three=one; four=two; one=$4; two=$8;} else { three=$4; four=$8;} }; if (one+two==0 || one+three==0 || three+four==0 || two+four==0) {print "NaN"} else {N=one+two+three+four; adbc= abs(one*four-two*three)-N/2; print N*adbc*adbc/(one+three)/(two+four)/(one+two)/(three+four) "\t" $9 } }' | python chisqpro.py | sort -k1,1g > chisq.txt; date
head -15 chisq.txt | python nsnp.py /proj/b2012036/INBOX/Dhany/SomaticCaller/snv_TN.filtered.vcf